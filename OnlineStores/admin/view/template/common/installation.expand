<!DOCTYPE html>
<html {{ lang('direction') == 'rtl' ? 'lang="ar"' : 'lang="en"' }} {{ lang('direction') == 'rtl' ? 'dir="rtl"' : 'dir="ltr"' }}>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ lang('heading_title') }}</title>
    <base href="{{ base.base }}"/>

    <link rel="shortcut icon" type="image/x-icon" href="https://cdn.expandcart.com/wp-content/uploads/2015/12/favicon.png">
    <link rel="apple-touch-icon" href="https://cdn.expandcart.com/wp-content/uploads/2015/12/favicon.png">
    <!--<link href="view/assets/css/{{ lang('direction')|upper }}/icons/fontawesome/styles.min.css?bn={{ BuildNumber }}" rel="stylesheet" type="text/css">-->
   <!-- Global stylesheets -->
	<!-- <link href="https://fonts.googleapis.com/css?family=Cairo:200,300,400,600,700,900|Montserrat:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i&amp;subset=arabic" rel="stylesheet">
   
    <link href="view/assets/css/{{ lang('direction')|upper }}/icons/icomoon/styles.css?bn={{ BuildNumber }}" rel="stylesheet" type="text/css">
    <link href="view/assets/css/{{ lang('direction')|upper }}/bootstrap.css?bn={{ BuildNumber }}" rel="stylesheet" type="text/css">
    <link href="view/assets/css/{{ lang('direction')|upper }}/core.css?bn={{ BuildNumber }}" rel="stylesheet" type="text/css">
    <link href="view/assets/css/{{ lang('direction')|upper }}/components.css?bn={{ BuildNumber }}" rel="stylesheet" type="text/css">
    <link href="view/assets/css/{{ lang('direction')|upper }}/colors.css?bn={{ BuildNumber }}" rel="stylesheet" type="text/css">
    <link href="view/assets/css/style.css?bn={{ BuildNumber }}" rel="stylesheet" type="text/css"> -->
    <!-- /global stylesheets -->
    <!-- <link rel="stylesheet" href="view/assets/css/shipping_methods_form.css"> -->
    <!-- design system links local-->
    <!-- <link href="view/new_assets/exports/css/main-{{lang('direction')}}.css?bn={{ BuildNumber }}" rel="stylesheet" type="text/css"> -->
    <!-- LTR -->

    <!-- <link href="view/assetsjs/plugins/iti/css/{{ lang('direction')|upper }}/site.css?bn={{ BuildNumber }}" rel="stylesheet" type="text/css"> -->

    {# <link href="view/assets/js/plugins/iti/css/intlTelInput-DS.css" rel="stylesheet" type="text/css"> #}
   {# <link rel="stylesheet" href="view/build/css/intlTelInput.css?bn={{ BuildNumber }}"> #}


    <!-- RTL -->
    <!-- <link href="view/new_assets/exports/css/main-{{lang('direction')}}.css?bn={{ BuildNumber }}" rel="stylesheet" type="text/css"> -->
<!-- 
	<link href="http://127.0.0.1/ecdesign-cdn/atomic-core/icons/icomoon/style.css" rel="stylesheet" type="text/css">
	<link href="http://127.0.0.1/ecdesign-cdn/cdn/main-{{lang('direction')}}.css" rel="stylesheet" type="text/css"> -->


    <!-- <link href="view/new_assets/exports/css/main-rtl.css" rel="stylesheet" type="text/css">  -->

    <!-- design system links-->
    <link href="view/new_assets/exports/css/main-{{direction}}.css?bn={{ BuildNumber }}" rel="stylesheet" type="text/css"> 
	<link href="https://designsystem.myexpandcart.dev/atomic-core/icons/icomoon/style.css" rel="stylesheet" type="text/css">
	<link href="https://designsystem.myexpandcart.dev/cdn/main-{{direction}}.css" rel="stylesheet" type="text/css">

    <!-- <script type="text/javascript" src="view/assets/js/core/libraries/bootstrap.min.js"></script> -->
    <!-- <script>
        $(document).ready(function() {
            $("#sell-select, #industry-select, #products-select").select2();
        })   
    </script> -->
    
    

 
    <!-- Core JS files -->
    <!-- <script type="text/javascript" src="view/assets/js/plugins/loaders/pace.min.js"></script>
    <script type="text/javascript" src="view/assets/js/plugins/loaders/blockui.min.js"></script>
    <script type="text/javascript" src="view/assets/js/plugins/clipboard/clipboard.min.js"></script>
    <!-/core JS files -->

    <!-- Theme JS files -->
    <!-- <script type="text/javascript" src="view/assets/js/plugins/forms/validation/validate.min.js"></script>
    <script type="text/javascript" src="view/assets/js/plugins/forms/styling/uniform.min.js"></script>
    <script type="text/javascript" src="view/assets/js/core/extapp.js?bn={{ BuildNumber }}"></script> -->
    <!-- /theme JS files -->
    <!-- <style>
        body:not(.light-form-body) {
            padding: 0 !important
        }
    </style> -->
	<style>
	.required,.error { color:red } 
	.log-in.reset--nav .log-in__entry__footer {padding : 0px 35px !important}
	.no-search span.select2-search.select2-search--dropdown {display: none;}
	</style>
    <!-- Hotjar Tracking Code for www.expandcart.com -->
    <script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:1840797,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
    </script>
</head>

<body class="login-container" {{ lang('direction') == 'rtl' ? 'dir="rtl"' : 'dir="ltr"' }}>
    <div class="log-in reset--nav">
        <nav class="log-in__nav">
            <div class="log-in__nav-logo">
                <a class="" href="">
                    <img class="logo" src="view/assets/images/{{logoPath}}">
                </a>
            </div>
            <div class="log-in__nav__lang">
                <div class="lang-tabs">
                    <ul class="lang-tabs__nav">
                        <li>
                            <a href="#" class="lang-btn" onclick="event.preventDefault();document.forms.lang.submit();">
                                <img src="view/image/flags/{{change_language.image}}" title="" class="">
                                {{ change_language.name }}
                            </a>
                            <form method="POST" id="lang">
                                <input type="hidden" name="config_admin_language" value="{{lang('direction') == 'ltr' ? "ar" : "en"}}">
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="installation-container">
            <div class="installation-slider">
                <ul class="list2">
                    <li class="active animated">
                        <h1 class="display-xs gray-900 text-center">{{lang('text_lets_get_to_know')}}</h1>
                        <div class="container">
                            <div class="log-in__entry">
                                <div class="log-in__entry-container">
                                    <div class="log-in__entry-container__form">
                                        <!-- Q1 --> 
										<div class="form-group" id="input-name-group">
                                            <label for="sell-select" class="control-label">
                                                {{lang('text_are_you_selling_currently')}} <span class="required"> * </span>
                                            </label>
                                            <select id="is-selling" name="setting[is_selling]" class="form-select required-field-toSubmit "  data-placeholder="" required>
                                                <option></option>
                                                {% for key, answer in is_selling %}
                                                    <option value="{{answer}}">{{lang("text_is_selling_" ~ key)}}</option>
                                                {% endfor %}
                                            </select>
											<span class="error is_selling_err"></span>
                                        </div>
										<!--# Q1 --> 
										<!-- Q2 --> 
										<div class="form-group" id="input-name-group">
                                            <label for="sell-select" id="is_selling_Yes" class="control-label">
                                                {{lang('text_how_do_you_currently_sell_your_product')}} <span class="required"> * </span>
                                            </label>
                                            <label for="sell-select" id="is_selling_No" class="control-label" style="display:none;">
                                                {{lang('text_which_channel_do_you_want_to_sell_on_later')}} <span class="required"> * </span>
											</label>
                                            <select name="setting[selling_channels][]" class="multi-select-input generic-select required-field-toSubmit" multiple="multiple" data-placeholder="">
                                                <option></option>
                                                {% for key, channel in selling_channel %}
                                                    <option value="{{channel}}">{{lang("text_channel_" ~ key)}}</option>
                                                {% endfor %}
                                            </select>
											<span class="error selling_channels_err"></span>
                                        </div>
										<!-- #Q2 --> 
										<!-- Q3 --> 
                                        <div class="form-group" id="input-name-group">
                                            <label for="products-select" class="control-label">
                                                {{lang('text_how_do_you_source_your_products')}} <span class="required"> * </span>
                                            </label>
                                            <select name="setting[product_sources][]" id="products-select" class="multi-select-input required-field-toSubmit" multiple="multiple" data-placeholder="">
                                                <option></option>
                                                {% for key, source in product_source %}
                                                    <option value="{{source}}">{{lang("text_channel_" ~ key)}}</option>
                                                {% endfor %}
                                            </select>
											<span class="error product_sources_err"></span>
                                        </div>
										<!-- #Q3 --> 
										
										<!-- Q4 --> 
                                        <div class="form-group" id="input-name-group">
                                            <label for="range-select" class="control-label">
                                                {{lang('text_how_many_orders_do_you_receive_monthly')}} <span class="required"> * </span>
                                            </label>
                                            <select name="setting[sales_range]" id="range-select"   class="required-field-toSubmit" data-placeholder="">
                                                <option></option>
                                                {% for key, range in sales_range %}
                                                    <option value="{{key}}">{{lang("text_sales_range_" ~ key)}}</option>
                                                {% endfor %}
                                            </select>
											<span class="error sales_range_err"></span>
                                        </div>
										<!-- #Q3 --> 
										
										<!-- Q5 --> 
                                        <div class="form-group" id="input-name-group">
                                            <label for="industry-select" class="control-label">
                                                {{lang('text_what_is_your_business_industry')}} <span class="required"> * </span>
                                            </label>
                                            <select name="setting[product_types][]" id="industry-select" class="multi-select-input required-field-toSubmit" multiple="multiple" data-placeholder="">
                                                <option></option>
                                                {% for key, product in product_type %}
                                                    <option value="{{key}}">{{lang("text_storeName_" ~ key)}}</option>
                                                {% endfor %}
                                            </select>
											<span class="error product_types_err"></span>
                                        </div>
										<!-- #Q5 -->
										
										<!-- Q6 --> 
                                      <div class="form-group" id="input-name-group">
                                            <label for="industry-select" class="control-label installation-container__label">
                                                {{lang('text_is_your_business_registered')}} <span class="required"> * </span>
                                            </label>
                                            {% for answer in registered_business %}
                                                <label class="theme-radio">
                                                    <input type="radio" name="setting[registered_business]" value="{{answer.value}}" class="required-field-toSubmit">
                                                    <span class="checkmark"></span>
                                                    <div class="radio-content">
                                                        <p class="title">{{answer.label}}</p>
                                                    </div>
                                                </label>
                                            {% endfor %}
											
											<span class="error registered_business_err"></span>
                                        </div>
										<!-- Q6 -->
										
                                    </div>
                                </div>
                            </div>
                        </div>
                  
                    </li>
					<!--
                    <li class="animated">
                        <h1 class="display-xs gray-900 text-center">{{lang('text_store_information')}}</h1>
                        <div class="container">
                            <div class="log-in__entry">
                                <div class="log-in__entry-container">
                                    <div class="log-in__entry-container__form">
                                        <div class="form__base">
                                            <div class="form-group" id="input-name-group">
                                                <label for="input-name" class="control-label">
                                                    {{lang('text_store_currency')}}
                                                </label>
                                            
                                                <select name="setting[currencies][]" id="currency-select" class="multi-select-input" multiple="multiple" data-placeholder="">
                                                    <option></option>
                                                    {% for currency in currencies %}
                                                        <option value="{{currency.currency_id}}" {{currency.default ? 'selected' : ''}}>{{currency.code}}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                            <div class="form-group" id="input-name-group">
                                                <label for="input-name" class="control-label">
                                                    {{lang('text_store_language')}}
                                                </label>
                                            
                                                <select name="setting[languages][]" id="lang-select" class="multi-select-input" multiple="multiple" data-placeholder="">
                                                    <option></option>
                                                    {% for code, name in languages %}
                                                        <option value="{{code}}" {{config('config_admin_language') == code ? 'selected' : ''}}>{{name}}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div>

                                        <div class="contact__customer">
                                            <h3 class="text-lg gray-900">{{lang('text_how_your_customers_should_contact_you')}}</h3>

                                            <div class="form-group general-phone-group" id="input-telephone-group">
                                                <label for="input-telephone" class="control-label">
                                                    {{lang('text_phone_number')}} ({{lang('text_optional')}})
                                                </label>
                                            
                                                <input type="tel" class="general-phone-input" name="" id="input-telephone" value="">
                                                <input type="hidden"  name="setting[country_code]">
                                            </div>

                                            <div class="form-group" id="input-email-group">
                                                <label for="input-email" class="control-label">
                                                    {{lang('text_store_email')}} ({{lang('text_optional')}})
                                                </label>
                                            
                                                <input type="email" class="form-control" name="setting[email]" id="input-email" value="{{setting.email}}">
                                            </div>

                                            <div class="form-group" id="input-address-group">
                                                <label for="input-address" class="control-label">
                                                    {{lang('text_store_address')}} ({{lang('text_optional')}})
                                                </label>
                                            
                                                <textarea class="form-control" name="setting[address]" id="input-address" value="{{setting.address}}"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>-->
                </ul>
                <div class="log-in__entry__footer">
			
                    <div class="log-in__entry__footer__copyright">
                        <button id="installation__prev" class="base-btn secondary-gray-btn d-none">{{lang('text_back')}}</button>

                    </div>
                    <!--<div class="installation-slider__bullets">
                        <span class="bg-primary-100 active"></span>
                        <span class="bg-primary-100"></span>
                    </div>-->
                    <div class="log-in__entry__footer__email">
                        <!--<button id="installation__next" class="base-btn">
                            <span class="next__install">{{lang('text_next')}}</span>
                            <span class="finish__install">{{lang('text_finish')}}</span>
                            <i class="icomoon-arrow-right ml-2"></i>
                        </button>-->
						<button id="finish_install" class="base-btn" disabled="disabled">
                          {{lang('text_finish')}}
                        </button>
                    </div>
                </div>
                
            </div>
            <!--start success page step-->
            <div class="installation-container__success" style="display:none;">
			
                <img src="view/assets/images/success-install.png">
                <h2 class="display-xs text-center gray-900">{{lang('text_you_have_done')}}</h2>
                <p class="text-xl text-center gray-600">{{lang('text_please_wait_until_preparing_store')}}</p>
                <div class="text-center mt-4">
                    <span class="installation-spinner"></span>
                </div>
			</div>
            <!--end success page step-->
        </div>
    </div>
    <!--end install steps-->
    

    <!-- {# welcome #}
    {# {% if WELCOME_PAGE != 1 %}
    <section class="install-welcome">
        <img src="view/assets/images/homepage/welcome-balon.gif" class="img-responsive img-rounded" alt="">
        <p class="congrat">{{lang('text_congrat')}}</p>
        <p class="info-content">{{lang('text_have_online_store')}}</p>
        <button class="next-arrow-btn start-install-btn" type="button">
            {{lang("button_start_discover")}}
            <i class="fa fa-angle-right" aria-hidden="true"></i>
        </button>
    </section>
    {% endif %} #}
    {# welcome #}

    {# start head #}
    <div class="ini-head">
        <div class="container">
            <div class="inner">
                <img src="view/assets/images/logo_dark.png" alt="" class="logo">
                <button class="lang-btn">
                    {{change_language.name}}
                </button>
            </div>
        </div>
    </div>
    {# end head #}

    {# start steps body #}
    <div class="ini-body">
        <div class="container">

            <form class="steps-box" id="ini_steps">
                <div class="step active text-center">
                    <p class="step-hint">
                        {{lang("text_aboutStore_sellStatus_hint")}}
                    </p>
                    <p class="step-title">
                        {{lang("text_aboutStore_sellStatus")}} <span class="stor-name-text"></span>
                    </p>

                    <input type="checkbox" class="hide" name="previous_website" id="have_website">

                    <div class="content-img-check-row grid-4">
                        {% for key, channel in selling_channel %}
                        <label class="content-img-check">
                            <input type="radio" class="hide" name="selling_channel" value="{{channel}}">
                            <span class="check-content">
                                <span class="img">
                                    <img src="view/assets/images/installation/{{key == 'website' ? 'validwebsite' : key}}.svg" alt="" class="">
                                </span>
                                <span>{{lang("text_channel_" ~ key)}}</span>
                            </span>
                        </label>
                        {% endfor %}
                    </div>

                </div>
                <div class="step text-center">
                    <p class="step-hint">
                        {{lang("text_aboutStore_productSource_hint")}}
                    </p>
                    <p class="step-title">
                        {{lang("text_aboutStore_productSource")}} <span class="stor-name-text"></span>
                    </p>

                    <div class="content-img-check-row grid-3">
                        {% for key, source in product_source %}
                        <label class="content-img-check">
                            <input type="radio" class="hide" name="product_source" value="{{source}}">
                            <span class="check-content">
                                <span class="img">
                                    <img src="view/assets/images/installation/{{key}}.svg" alt="" class="">
                                </span>
                                <span>{{lang("text_channel_" ~ key)}}</span>
                            </span>
                        </label>
                        {% endfor %}
                    </div>
                    
                </div>
                <div class="step text-center">
                    <p class="step-hint">
                        {{lang("text_registered_business_hint")}}
                    </p>
                    <p class="step-title">
                        {{lang("text_registered_business")}} <span class="stor-name-text"></span>
                    </p>

                    <div class="content-img-check-row grid-3">
                        <label class="content-img-check">
                            <input type="radio" class="hide" name="registered_business" value="Yes">
                            <span class="check-content">
                                <span class="img">
                                    <img src="view/assets/images/installation/registered.svg" alt="" class="">
                                </span>
                                <span>{{lang("text_registered")}}</span>
                            </span>
                        </label>
                        <label class="content-img-check">
                            <input type="radio" class="hide" name="registered_business" value="No">
                            <span class="check-content">
                                <span class="img">
                                    <img src="view/assets/images/installation/not_registered.svg" alt="" class="">
                                </span>
                                <span>{{lang("text_not_registered")}}</span>
                            </span>
                        </label>
                        <label class="content-img-check">
                            <input type="radio" class="hide" name="registered_business" value="Not Yet">
                            <span class="check-content">
                                <span class="img">
                                    <img src="view/assets/images/installation/will_registered.svg" alt="" class="">
                                </span>
                                <span>{{lang("text_will_registered")}}</span>
                            </span>
                        </label>
                    </div>

                </div>
                <div class="step content-inner">
                    <p class="step-hint text-center">
                        {{lang("text_productsTypes_hint")}}
                    </p>
                    <p class="step-title text-center">
                        {{lang("text_productsTypes_title")}}
                    </p>
                    <div class="content-check-row">
                        {% for key, product in products_types %}
                        <label class="content-check">
                            <input type="checkbox" class="hide" name="products_types[]" value="{{key}}">
                            <span class="check-content">
                                <img src="view/assets/images/installation/{{key}}.svg" alt="" class="">
                                {{lang("text_storeName_" ~ key)}}
                            </span>
                        </label>
                        {% endfor %}
                    </div>
                </div>
                <div class="progress-container">
                    <div class="progress-step active"></div>
                    <div class="progress-step"></div>
                    <div class="progress-step"></div>
                    <div class="progress-step"></div>
                </div>
            </form>
        </div>
    </div>
    <i class="fa fa-angle-left ini-prev-step" aria-hidden="true"></i>
    {# end steps body #}

    {# start loader #}
    <div class="ini-loader">
        <p class="title">
            {{lang("word_great")}}
        </p>
        <p class="info-content">
            {{lang("text_loading_title")}}
        </p>
        <span class="spin"></span>
    </div>
    {# end loader #}
    <script>
        $('.start-install-btn').click(function() {
            $('.install-welcome').fadeOut()
        });

        // lisiten i have own website radio with out checkbox
        $('.content-img-check input').change(function() {
            if($('input[value="Website"]').prop("checked")) {
                $('#have_website').prop("checked", true)
            } else {
                $('#have_website').prop("checked", false)
            }
        })

        let activeStep = 0;
        $('.content-img-check input').click(function() {
            nextStepAction()
            progressAction();
        });
        $('.content-check input').click(function() {
            submitAction()
            progressAction();
        });
        $('.ini-prev-step').click(function() {
            prevStepFunc();
            progressAction();
        });

        let progressAction = function() {
            $(".progress-container .progress-step").eq(activeStep).addClass('active');
            $(".progress-container .progress-step").eq(activeStep).prevAll().addClass('active');
            $(".progress-container .progress-step").eq(activeStep).nextAll().removeClass('active');
        }
        
        let nextStepAction = function() {
            $('.step').eq(activeStep).slideUp();
            $('.step').eq(activeStep + 1).slideDown();
            activeStep++
            
            activeStep > 0 && $('.ini-prev-step').addClass('active');
        }
        let submitAction = function() {
            $('.ini-loader').addClass('show-loader');
            $.ajax({
                url: '{{ link('common/installation') }}',
                type: 'post',
                data: $('#ini_steps').serialize(),
                success: function (resp) {
                    window.location = JSON.parse(resp).redirect_to
                },
                error: function(err) {
                    alert('error')
                }
            });
        }

        let prevStepFunc = function() {
            $('.step').eq(activeStep).slideUp();
            $('.step').eq(activeStep - 1).slideDown();
            activeStep = activeStep - 1;
            activeStep == 0 && $('.ini-prev-step').removeClass('active');
        };
        
        $('.ini-head .lang-btn').click(function() {
            $.ajax({
                url: '{{ link('common/installation/language') }}',
                type: 'post',
                data: 'config_admin_language={{lang('direction') == 'ltr' ? "ar" : "en"}}',
                success: function (resp) {
                    location.reload();
                },
                error: function(err) {
                    alert('error')
                }
            });
        })
    </script> -->

    <!-- <script type="text/javascript" src="view/assets/js/core/libraries/jquery.min.js"></script> -->
    <!-- design system js links  -->
    <!-- <script type="text/javascript" src="http://127.0.0.1/ecdesign-cdn/cdn/expand-docs.js"></script> -->

    <!-- {# <script type="text/javascript" src="view/assets/js/plugins/iti/js/intlTelInput-DS.js"></script> #} -->
    <!-- <script type="text/javascript" src="view/assets/js/plugins/iti/js/intlTelInput-jquery.js"></script> -->
  


    {# Tracking events #}
    <script type="text/javascript" src="view/new_assets/exports/js/scripts.min.js"></script>
	<script type="text/javascript" src="https://designsystem.myexpandcart.dev/cdn/expand-docs.js"></script>
    <script type="text/javascript" src="view/assets/js/plugins/forms/selects/select2.min.js"></script>
    <script src="view/assets/js/plugins/mixpanel/mixpanel.js"></script>
	<script src="view/assets/js/plugins/amplitude/amplitude.js"></script>
    <script type="text/javascript" src="view/build/js/intlTelInput.js?bn={{ BuildNumber }}"></script>

	<script>
 
            if($('.installation-slider').length > 0 ){
                $("#sell-select, #industry-select, #products-select, #currency-select , #lang-select, .generic-select").select2();
                $("#is-selling, #range-select").select2({
					dropdownCssClass : 'no-search'
				}); 
                $('.select2-selection.select2-selection--multiple').append(`<span class="icomoon-chevron-down" style="
                "></span>`);

                $('.general-phone-input').intlTelInput({
                utilsScript: "https://designsystem.myexpandcart.dev/atomic-core/js/utils.js"
                })



                $('.general-phone-input').on('keydown', function() {
                $(this).parents('.general-phone-group').removeClass('has-error')
                })

                $('.general-phone-input').on('focusout', function() {
                    if($(this).val() != '' && !$(this).intlTelInput("isValidNumber")){
                        $(this).parents('.general-phone-group').addClass('has-error')
                    }
                })
            } 
		window.tracking = window.tracking || (function() {
            var userId = "{{ constant('STORECODE') }}";
            var start = new Date();
            try {
                // init amplitude & mixpanel config
                mixpanel.init("{{ constant('MIXPANEL_TOKEN') }}", {batch_requests: true})
                amplitude.getInstance().init("{{ constant('AMPLITUDE_TOKEN') }}");

                mixpanel.identify(userId.toUpperCase());
                amplitude.setUserId(userId.toUpperCase());
            } catch (error) {
                console.warn(error);
            }
            function track(event, data={}){
                try {
                    mixpanel.track(event, data);
                    amplitude.getInstance().logEvent(event, data);
                } catch (error) {
                    console.warn(error);
                }
            }
            function incrementProperty(prop, increment=1) {
                try {
                    let _data = {[prop]: increment};
                    mixpanel.people.increment(_data);
                } catch (error) {
                    console.warn(error);
                }
            }
            function getStart() {
                return start.toISOString();
            };
            // thanks https://stackoverflow.com/users/1381240/dusht
            function msToTime(duration) {
                var milliseconds = Math.floor((duration % 1000) / 100),
                    seconds = Math.floor((duration / 1000) % 60),
                    minutes = Math.floor((duration / (1000 * 60)) % 60),
                    hours = Math.floor((duration / (1000 * 60 * 60)) % 24);
                hours = (hours < 10) ? "0" + hours : hours;
                minutes = (minutes < 10) ? "0" + minutes : minutes;
                seconds = (seconds < 10) ? "0" + seconds : seconds;
                return `${hours}h:${minutes}m:${seconds}.${milliseconds}s`;
            }
            function getElapsed() {
                return msToTime(new Date() - start);
            };
            function setStart() {
                start = new Date();
            };
            return {
                track, 
                increment: incrementProperty,
                getStart,
                setStart,
                getElapsed,
            };
        }());
	</script>
    <script>
    $(function() {
        $('#installation__prev').on('click', function(e) {
            tracking.increment('Onboarding2 - Back Button');
        });
        
        $(window).on("beforeunload", function() { 
            // tracking.increment('Onboarding2 - Exit Rate');
            tracking.increment('Onboarding2 - Exit Rate ' + $('.installation-slider li.active').is(':last-child') ? 'Store Setting' : 'Onboarding Question');
        });
        
                // tel input init
        (function() {
            let telInput = jQuery("#input-telephone"),
                iti = telInput.intlTelInput({
                    initialCountry: "auto",
                    nationalMode: true,
                    preferredCountries: [],
                    hiddenInput: "setting[telephone]",
                    utilsScript: "{{ link('view/build/js/utils.js') }}",
                    geoIpLookup: function(callback) {
                        jQuery.get('https://ipinfo.io', function() {}, "jsonp").always(function(resp) {
                            var countryCode = (resp && resp.country) ? resp.country : "";
                            callback(countryCode);
                            $('[name="setting[country_code]"]').val("+" + countryCode);
                        });
                    },
                });
            // empty phone val when change cuntry
            telInput.on('countrychange',function (evt, data) {
                telInput.val('');
                $('[name="setting[country_code]"]').val("+" +data.dialCode);
            });
            telInput.on('keyup', function() {
                let that = $(this);
                $('[name="setting[telephone]"]').val(that.intlTelInput('isValidNumber') ? that.intlTelInput('getNumber') : '');
            });
        }());
        
        //$(document).on("click", '.finish--install', function (evt) {
        $(document).on("click", '#finish_install', function (evt) {
            var inputData = $('body').find("input:not('[name=config_admin_language]'),select,textarea").serialize();
				console.log('inputData',inputData);
            $.ajax({
                url: '{{ link('common/installation') }}',
                type: 'post',
                data:inputData,
                beforeSend: function() {
                    $('.installation-slider').hide();
                    $('.installation-container__success').show();  
                },
                success: function (resp) {
                    resp = JSON.parse(resp);
                    if ('success' in resp && resp.success == 1) {
                        tracking.track('Onboarding2 - Fields Input', (function() {
                            return $('body')
                                .find("[name='setting[currencies][]'], [name='setting[languages][]']")
                                .serializeArray()
                                .reduce(function(a, b) {
                                    let k = b.name.replaceAll('[', '').replaceAll(']', '').replace('setting', ''), v = b.value;
                                    a[k] = (k in a ? (a[k] + ',') : '' ) + v;
                                    return a;
                                }, {});
                        }()));
                        tracking.track('Onboarding2 - Finishing Time', {time: tracking.getElapsed(), 'Step Name' : 'Onboarding Question & Store Setting'});
                        location = resp.redirect_to;
                    }else {
						
						$(".installation-slider").show();
						$(".installation-container__success").hide();
						
						
						for (err in resp.errors) {

							var error = resp.errors[err];
							$("input[name='"+err+"']").closest('.form-group').addClass('has-error');
							$('.'+err+'_err').html(resp.errors[err])
						}
					}
                },
                error: function(err) {
                    console.log(err);
                }
            });
        });
    });
	
 $('#is-selling').change(function(){
		if($(this).val() === 'Yes, I sell products'){
			$("#is_selling_Yes").show();
			$("#is_selling_No").hide();
		}else {
			$("#is_selling_Yes").hide();
			$("#is_selling_No").show();
		}
 });
	
function formEmptyCheck(){
   
   var empty = false;
    $('.form-group .required-field-toSubmit').each(function() {
            
		if ($(this).val() === '' || $(this).val() === null ) {
             empty = true;
        }
    });
	
	var register_selected = $('input[name="setting[registered_business]"]:checked').val()  != undefined ;
	
	if (empty || !register_selected) {
            $('#finish_install').attr('disabled', 'disabled');
    } else {
            $('#finish_install').removeAttr('disabled');
    }
};

$('.form-group .required-field-toSubmit').change(function() {
    formEmptyCheck();
 });
	formEmptyCheck();
   </script>
</body>
</html>
